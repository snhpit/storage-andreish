<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Puzzle</title>
    <script type="text/javascript" src="Scripts/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="Scripts/jquery.tmpl.js"></script>
    <link rel="stylesheet" href="Styles/puzzle.css" type="text/css">

    <script id="squareTemplate" type="text/x-jquery-tmpl">
        {{each indexes}}
            <div class="square" data-value="${$value}">
                <span>${$value}</span>
            </div>
        {{/each}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            //var context = this;
            $("#compile").click(function () { clickCompile(); });
            $("#reset").click(function() { clickReset(); });

            //var inputData;
            //var numberOfSquares;
            var data = { indexes: [] };

            function getNumber(inputData) {
                return Math.pow(inputData, 2);
            }

            function verifyInputData(value) {
                //var inputData;
                if (!isNaN(+value) && value > 1) {
                    return value;
                }
                return "undefined";
            }

            function numbering(numberOfSquares) {
                //var X = numberOfSquares - 1;
                for (var i = 0; i < numberOfSquares; i++) {
                    data.indexes[i] = i + 1;
                }
                data.indexes[numberOfSquares - 1] = "";
            }

            function compilePuzzleBox(sidesNumber) {
                var sizeSideSquare = "50";//$(".square").css("width"); ещё не созданные элементы
                var borderSquareLength = "1";//$(".square").css("border-width");
                $("#puzzle-box").css("width", sizeSideSquare * sidesNumber + sidesNumber * borderSquareLength * 2);
                $("#puzzle-box").css("height", sizeSideSquare * sidesNumber + sidesNumber * borderSquareLength * 2);
            }

            function clearSquares() {
                return $(".centerwrapper").empty();
            }

            //
            function mixing() {
                return Math.round(Math.random() * 3 + 1);
            }

            //
            function checkEmptySquare() {
                // проверка вверху/справа/снизу/слева ?
            }

            //
            function checkOutOfRange() {

            }

            /**
             * перемещение/замена квадратов
             */
            /**
             * проверка выигрышной ситуации
             */
            /**
             * анимация
             */
            
            function clickReset() {
                $("#reset")
            }

            function clickCompile() {
                var sidesNumber = $("#textInput").val();
                var verifyData = verifyInputData(sidesNumber);
                if (verifyData !== "undefined") {
                    var empty = clearSquares();
                    var numberOfSquares = getNumber(sidesNumber);
                    numbering(numberOfSquares);
                    compilePuzzleBox(sidesNumber);
                    $("#squareTemplate").tmpl(data).appendTo(".centerwrapper");
                }
            }
        });

    </script>
</head>
<body>

<div id="game">
    <!--<div class="centerwrapper"></div>-->
    <input type="text" id="textInput">
    <input type="button" id="compile" value="new game">
    <div id="puzzle-box">
        <div class="centerwrapper"></div>
    </div>
    <input type="button" id="reset" value="restart game">
</div>

</body>
</html>
